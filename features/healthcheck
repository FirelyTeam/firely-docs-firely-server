.. _feature_healthcheck:

$healthstatus, Health Check
===========================

Description
-----------

For a quick check to see if Firely Server is up and running, it provides the ``$healthstatus`` custom operation. You invoke it at the system level, so at the root:

.. code-block:: 

   <base-url>/$healthstatus

If you have assigned different endpoints to different FHIR versions (see :ref:`here <feature_multiversion_endpoints>`), you can also invoke it on each FHIR version. The result is always the same for all versions that are configured in the server. E.g:

.. code-block:: 

   <base-url>/R4/$healthstatus

Results
-------

The ``$healthstatus`` operation may return one of three http status codes:

#. 200 OK: Firely Server is up and running and ready to accept requests
#. 423 Locked: Firely Server is busy with a long running operation and cannot process requests.  This could among others be a :ref:`database migration <upgrade>` or an :ref:`import of conformance resources <conformance_import>`. The response will have an OperationOutcome with additional details.
#. 402 Payment Required: The license is expired or otherwise invalid.

The response code 423 may or may not be a problem in specific cases. For a Kubernetes probe or Docker healthcheck we recommend accepting both 200 and 423, otherwise Kubernetes might restart the pod while the long running operation is still in progress.

Configuration
-------------

The healthcheck service should be configured in the pipeline, see :ref:`vonk_plugins_healthcheck`. In the default settings this is the case.
The healthcheck plugin has no configuration in the :ref:`appsettings <configure_appsettings>`.
